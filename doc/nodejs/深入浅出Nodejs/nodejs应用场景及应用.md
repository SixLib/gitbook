# 应用场景及应用

<!-- @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=6 orderedList=false} -->

<!-- code_chunk_output -->

* [应用场景及应用](#应用场景及应用)
	* [应用场景](#应用场景)
		* [I/O密集型](#io密集型)
		* [是否不擅长CPU密集型业务](#是否不擅长cpu密集型业务)
		* [与遗留系统和平共处](#与遗留系统和平共处)
		* [分布式应用](#分布式应用)
	* [应用](#应用)
		* [前后端编程语言环境统一](#前后端编程语言环境统一)
		* [Node带来的高性能I/O用于实时应用](#node带来的高性能io用于实时应用)
		* [并行I/O使得使用者可以更高效地利用分布式环境](#并行io使得使用者可以更高效地利用分布式环境)
		* [并行I/O，有效利用稳接口提升Web渲染能力](#并行io有效利用稳接口提升web渲染能力)
		* [云计算平台提供Node支持](#云计算平台提供node支持)
		* [游戏开发领域](#游戏开发领域)

<!-- /code_chunk_output -->
## 应用场景

### I/O密集型

Node面向网络且擅长并行I/O，能够有效地组织起更多的硬件资源，从而提供更多好的服务。
I/O秘籍的优势主要在于Node利用时间循环的处理能力，而不是在启动每一个线程为每一个请求服务，资源占用极少。

### 是否不擅长CPU密集型业务

在CPU秘籍的应用场景中，Node是否能胜任呢？实际上，V8的执行效率是十分高的。单以执行效率来做评判，V8的执行效率是毋庸置疑的。

关于CPU密集型应用，Node的异步I/O已经解决了在单线程上CPU与I/O之间阻塞无法重叠利用的问题，I/O阻塞造成的性能良妃远比CPU的影响小。对于长时间运行的计算，如果它的耗时超过普通阻塞I/O的耗时，那么应用场景就需要重新评估了，因为这类计算比阻塞I/O还影响效率，甚至说这是一个春计算场景，根本没有I/O。此类应用场景或许应当采用多线程的方式进行计算。Node虽然没有提供多线程用于计算支持，但是还是有一下两个方式来充分利用CPU。

- Node可以通过编写C/C++扩展的方式更高效地利用CPU，将一些V8不能做到性能机制的地方通过C/C++来实现。C/C++扩展的方式实现计算，速度比Java要快。

- 如果单线程的Node不能满足需求，甚至用了C/C++扩展后还是觉得不够，那么通过子进程的方式，将一部分Node进程当做常驻服务进程用于计算，然后利用进程间的消息来传递结果，将计算与I/O分离，这样还能充分利用多CPU。

### 与遗留系统和平共处

LinkedIn在他们的移动版网站上的实践非常典型地说明了这个问题。旧有的系统具有分厂稳定的数据输出，持续为传统网站服务，同时为移动版提供数据源，Node将该数据源当做数据接口，发挥异步并行的优势，而不用关心它背后是用什么语言实现的。

这方面，国内的雪球财经也有很好的实践。雪球财经是从旧有的Java项目中分离出一个子项目，在这个子项目中，没有继续采用Java/JSP而是采用Node来完成Web端的开发，=使得前端工程师在HTTP协议栈的两端能够搞笑领过地开发，避免了Java繁琐的表达；另一方面，又利用Java作为后端接口和中间件，使其具有良好的稳定性。两者互相结合，取长补短。

### 分布式应用

阿里巴巴的数据平台对Node的分布式应用算是一个典型的例子。分布式应用意味着对可伸缩性的要求非常高。数据平台通长要在一个数据库集群中去寻找需要的数据。阿里巴巴开发了中间层应用NodeFox、ITier，将数据库集群做了划分和映射，查询调用依旧是针对单张表进行SQL查询，中间层分解查询SQL，并行地去多台数据库中获取数据并合并。NodeFox能实现对多台MySQL数据库的查询，如何查询一台MySQL一般，而iTier更强大，查询多个数据库如同查询单个数据库一般，这里的多个数据库是指不同的数据库，如MySQL或者其他的数据库。

这个案例其实也是高效利用并行I/O的例子。Node高效利用并行I/O的过程，也是使用数据库的过程。对于Node，这个行为只是一次普通的I/O。对于数据库而言，却是一次复杂的计算，所以也是进而充分压榨硬件资源的过程。

## 应用

### 前后端编程语言环境统一

这类倚重点的代表是雅虎。雅虎开放了Cocktail框架，利用自己身后的前端沉淀，将YUI3这个前端框架的能力借助Node眼神到服务器端，是的使用者摆脱了日常工作中一边写JavaScript一边写PHP所地阿莱的上下文交换负担。

### Node带来的高性能I/O用于实时应用

Voxer将Node应用在实时语音上。国内腾讯的朋友网将Node应用在长连接中，以提供实时功能，花瓣网、蘑菇街等公司通过socket.io实现实时通知的功能。

### 并行I/O使得使用者可以更高效地利用分布式环境

阿里巴巴和eBay是这方面的典型。阿里巴巴的NodeFox和ebayde ql.io都是借用Node并行I/O的能力，更高效地使用已有的数据。

### 并行I/O，有效利用稳接口提升Web渲染能力

雪球财经和LinkedIn的移动版网站均是这种案例。撇弃同步等待式的顺序请求，大胆采用并行I/O，加速数据的获取进而提升Web的渲染速度。

### 云计算平台提供Node支持

微软将Node引入Azure的开发中，阿里云、百度均纷纷在云服务器上提供Node应用托管服务，Joyent更是云计算中提供Node支持的代表。这类平台看中JavaScript带来的开发上的优势，以及低资源占用
、高性能的特点。

### 游戏开发领域

游戏领域对实时和高并发有喝高的要求，网易开源了pomelo实时框架，可以应用在游戏和高实时应用中。